multitenancyEnabled: true
storage:
  trace:
    backend: s3
    s3:
      endpoint: minio-dev.minio-dev.svc.cluster.local:9000
      bucket: tempo-bucket
      access_key: minioadmin
      secret_key: minioadmin
      insecure: true
distributor:
  replicas: 1
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/component: distributor

ingester:
  replicas: 1
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/component: ingester
  config:
    replication_factor: 1

compactor:
  replicas: 1
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/component: compactor
  config:
    compaction:
      block_retention: 720h  # データを30日間（720時間）保存

querier:
  replicas: 1
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/component: querier

queryFrontend:
  replicas: 2
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: kubernetes.io/hostname
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/component: query-frontend

# minio:
#   enabled: true
#   accessKey: O8MoDdnGvgC9wHNIx5U8
#   secretKey: mCMub3z49jGSJd8OaNKfrAnVUglxvH1w15OOig92
#   buckets:
#     - name: tempo-bucket
#       policy: none
#       purge: false
# global:
#   clusterDomain: cluster.local
# metaMonitoring:
#   serviceMonitor:
#     enabled: true

traces:
  otlp:
    grpc:
      enabled: true
    http:
      enabled: true